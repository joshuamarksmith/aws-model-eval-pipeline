"use strict";var a=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var y=Object.prototype.hasOwnProperty;var w=(e,n)=>{for(var o in n)a(e,o,{get:n[o],enumerable:!0})},b=(e,n,o,i)=>{if(n&&typeof n=="object"||typeof n=="function")for(let t of g(n))!y.call(e,t)&&t!==o&&a(e,t,{get:()=>n[t],enumerable:!(i=h(n,t))||i.enumerable});return e};var v=e=>b(a({},"__esModule",{value:!0}),e);var R={};w(R,{handler:()=>D});module.exports=v(R);var r=require("@aws-sdk/client-bedrock-runtime"),k=new r.BedrockRuntimeClient({}),S=new r.BedrockRuntimeClient({}),c=[{prompt:"Explain the difference between Tier\xA01 and Tier\xA02 capital.",reference:"Tier\xA01 capital consists primarily of common equity and disclosed reserves; Tier\xA02 includes subordinated debt, hybrid instruments, and loan\u2011loss reserves."},{prompt:"What triggers a SAR filing under the Bank Secrecy Act?",reference:"Any transaction of $5\u202F000 or more that the institution knows, suspects, or has reason to suspect involves funds derived from illegal activity, is designed to evade regulations, or has no lawful purpose."},{prompt:"State the Volcker Rule\u2019s main limitation on proprietary trading.",reference:"It generally prohibits banking entities from engaging in short\u2011term proprietary trading of securities, derivatives, and certain other instruments for the firm\u2019s own account."},{prompt:"Describe the purpose of the Net Stable Funding Ratio.",reference:"NSFR ensures banks maintain a stable funding profile in relation to the composition of their assets and off\u2011balance\u2011sheet activities over a one\u2011year horizon."},{prompt:"Define \u201Cbeneficial ownership\u201D under FinCEN\u2019s CDD rule.",reference:"Each legal\u2011entity customer must disclose any individual who owns 25\u202F% or more of the equity interests and one individual with significant managerial control."}],N="anthropic.claude-3-opus-20240229",C=.75,D=async e=>{console.log("Raw event:",JSON.stringify(e));let o=(e.detail??{}).modelId??"anthropic.claude-3-5-haiku-20241022-v1:0";console.log(`Invoking Bedrock model: ${o}`);let i=0;for(let{prompt:s,reference:d}of c){let l=await k.send(new r.InvokeModelCommand({modelId:o,contentType:"application/json",accept:"application/json",body:JSON.stringify({prompt:s,max_tokens_to_sample:192})})),p=JSON.parse(new TextDecoder().decode(l.body)).completion,m=`
You are an expert grader.  The candidate answer should be compared to the reference answer.
Give ONLY a JSON object with keys:
- "score" (integer 1\u20114 where 4 = fully correct)
Do not output any other text.

Question: ${s}
Reference answer: ${d}
Candidate answer: ${p}
`,u=await S.send(new r.InvokeModelCommand({modelId:N,contentType:"application/json",accept:"application/json",body:JSON.stringify({prompt:m,max_tokens_to_sample:32})})),f=JSON.parse(new TextDecoder().decode(u.body)).completion;i+=f.score??0}let t=i/(c.length*4);return{check:"LLMJudge",score:t,passed:t>=C}};0&&(module.exports={handler});
